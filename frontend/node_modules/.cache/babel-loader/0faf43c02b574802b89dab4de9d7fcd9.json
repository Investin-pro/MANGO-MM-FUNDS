{"ast":null,"code":"var _jsxFileName = \"/Users/zohebshahzan/code/Solana-2/frontend/src/components/AllFundsInvestors.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { createAssociatedTokenAccount, createAssociatedTokenAccountIfNotExist, createKeyIfNotExists, createTokenAccountIfNotExist, findAssociatedTokenAddress, setWalletTransaction, signAndSendTransaction } from '../utils/web3';\nimport { connection, FUND_ACCOUNT_KEY, platformStateAccount, PLATFORM_ACCOUNT_KEY, programId } from '../utils/constants';\nimport { GlobalState } from '../store/globalState';\nimport { PublicKey, Transaction, TransactionInstruction } from '@solana/web3.js';\nimport { TOKEN_PROGRAM_ID } from '@project-serum/serum/lib/token-instructions';\nimport { FUND_DATA, INVESTOR_DATA, PLATFORM_DATA, SPL_TOKEN_MINT_DATA, U64F64 } from '../utils/programLayouts';\nimport { Badge } from 'reactstrap';\nimport BN from 'bn.js';\nimport { Card, Col, Row, Table } from 'reactstrap';\nimport { Blob, seq, struct, u32, u8, u16, ns64, nu64 } from 'buffer-layout';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AllFundsInvestors = () => {\n  _s();\n\n  const [investments, setInvestments] = useState([]);\n  const [funds, setFunds] = useState([]);\n\n  const handleGetAllInvestments = async () => {\n    //  const userkey = new PublicKey('zRzdC1b2zJte4rMjfaSFZwbnBfL1kNYaTAF4UC4bqpx');\n    //  const key = walletProvider?.publicKey;\n    let investments = await connection.getProgramAccounts(programId, {\n      filters: [{\n        dataSize: INVESTOR_DATA.span\n      } // {\n      //   memcmp: { offset: INVESTOR_DATA.offsetOf('owner'), bytes: userkey.toBase58() }\n      // }\n      ]\n    }); // console.log(\"investments::\",investments)\n\n    const newInvestors = [];\n\n    for (const investment of investments) {\n      const invStateData = INVESTOR_DATA.decode(investment.account.data);\n      invStateData['ivnStatePubKey'] = investment.pubkey;\n\n      if (invStateData.is_initialized) {\n        newInvestors.push(invStateData);\n      }\n    }\n\n    console.log(\"newInvestors::\", newInvestors);\n    setInvestments(newInvestors);\n  };\n\n  const handleGetAllFunds = async () => {\n    const managers = [];\n    const allFunds = await connection.getProgramAccounts(programId, {\n      filters: [{\n        dataSize: FUND_DATA.span\n      }]\n    });\n\n    for (const data of allFunds) {\n      const decodedData = FUND_DATA.decode(data.account.data);\n\n      if (decodedData.is_initialized) {\n        managers.push({\n          fundState: decodedData,\n          fundPDA: decodedData.fund_pda.toBase58(),\n          fundManager: decodedData.manager_account.toBase58(),\n          vault_key: decodedData.vault_key.toBase58(),\n          mngo_vault_key: decodedData.mngo_vault_key.toBase58(),\n          mango_account: decodedData.mango_account.toBase58(),\n          mngo_per_share: decodedData.mngo_per_share.toString(),\n          mngo_manager: decodedData.mngo_manager.toString(),\n          mngo_accrued: decodedData.mngo_accrued.toString(),\n          total_mngo_accrued: decodedData.total_mngo_accrued.toString() // minAmount: (new TokenAmount(decodedData.min_amount.toNumber(), TOKENS.USDC.decimals)).toEther().toNumber()\n\n        });\n      }\n    }\n\n    console.log(\"managers:\", managers);\n    setFunds(managers);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"form-div\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: \"justify-content-center\",\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        className: \"justify-content-between\",\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          lg: \"12\",\n          xs: \"12\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Investments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleGetAllInvestments,\n            children: \" get All Investments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            className: \"tablesorter\",\n            responsive: true,\n            width: \"100%\",\n            style: {\n              overflow: 'hidden !important',\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-primary\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"index\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 86,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"ivnStatePubKey\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 87,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"manager\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 88,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"owner\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 89,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 90,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"mngo_debt\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 91,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"start_index\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 92,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"has_withdrawn\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 93,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"withdrawn_from_margin\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 94,\n                  columnNumber: 31\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: investments && investments.map((i, x) => {\n                var _i$ivnStatePubKey, _i$ivnStatePubKey2, _i$manager, _i$owner, _i$amount, _i$mngo_debt, _i$start_index;\n\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    children: x\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 103,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$ivnStatePubKey2 = i.ivnStatePubKey) === null || _i$ivnStatePubKey2 === void 0 ? void 0 : _i$ivnStatePubKey2.toBase58()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 104,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$manager = i.manager) === null || _i$manager === void 0 ? void 0 : _i$manager.toBase58()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 105,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$owner = i.owner) === null || _i$owner === void 0 ? void 0 : _i$owner.toBase58()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 106,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: (i === null || i === void 0 ? void 0 : (_i$amount = i.amount) === null || _i$amount === void 0 ? void 0 : _i$amount.toString()) / 10 ** 6\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 107,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$mngo_debt = i.mngo_debt) === null || _i$mngo_debt === void 0 ? void 0 : _i$mngo_debt.toString()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 108,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$start_index = i.start_index) === null || _i$start_index === void 0 ? void 0 : _i$start_index.toString()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 109,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.has_withdrawn\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 111,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.withdrawn_from_margin\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 112,\n                    columnNumber: 18\n                  }, this)]\n                }, i === null || i === void 0 ? void 0 : (_i$ivnStatePubKey = i.ivnStatePubKey) === null || _i$ivnStatePubKey === void 0 ? void 0 : _i$ivnStatePubKey.toBase58(), true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 102,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 8\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        className: \"justify-content-between\",\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          lg: \"10\",\n          xs: \"10\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Funds\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleGetAllFunds,\n            children: \" get All Funds\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            className: \"tablesorter\",\n            responsive: true,\n            width: \"100%\",\n            style: {\n              overflow: 'hidden !important',\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-primary\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"index\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 136,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"fundManager\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 137,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"fundPDA\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"vault_key\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 140,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"mngo_vault_key\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"mango_account\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 142,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"mngo_per_share\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 144,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"mngo_manager\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"mngo_accrued\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"total_mngo_accrued\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 147,\n                  columnNumber: 31\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: funds && funds.map((i, x) => {\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    children: x\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 159,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.fundManager\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.fundPDA\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 161,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.vault_key\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 163,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.mngo_vault_key\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 164,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.mango_account\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.mngo_per_share\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.mngo_manager\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.mngo_accrued\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 168,\n                    columnNumber: 18\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.total_mngo_accrued\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 18\n                  }, this)]\n                }, x, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 8\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AllFundsInvestors, \"Es7VZul840z8Rbk62bZDvpJrP9w=\");\n\n_c = AllFundsInvestors;\n\nvar _c;\n\n$RefreshReg$(_c, \"AllFundsInvestors\");","map":{"version":3,"sources":["/Users/zohebshahzan/code/Solana-2/frontend/src/components/AllFundsInvestors.js"],"names":["React","useEffect","useState","createAssociatedTokenAccount","createAssociatedTokenAccountIfNotExist","createKeyIfNotExists","createTokenAccountIfNotExist","findAssociatedTokenAddress","setWalletTransaction","signAndSendTransaction","connection","FUND_ACCOUNT_KEY","platformStateAccount","PLATFORM_ACCOUNT_KEY","programId","GlobalState","PublicKey","Transaction","TransactionInstruction","TOKEN_PROGRAM_ID","FUND_DATA","INVESTOR_DATA","PLATFORM_DATA","SPL_TOKEN_MINT_DATA","U64F64","Badge","BN","Card","Col","Row","Table","Blob","seq","struct","u32","u8","u16","ns64","nu64","AllFundsInvestors","investments","setInvestments","funds","setFunds","handleGetAllInvestments","getProgramAccounts","filters","dataSize","span","newInvestors","investment","invStateData","decode","account","data","pubkey","is_initialized","push","console","log","handleGetAllFunds","managers","allFunds","decodedData","fundState","fundPDA","fund_pda","toBase58","fundManager","manager_account","vault_key","mngo_vault_key","mango_account","mngo_per_share","toString","mngo_manager","mngo_accrued","total_mngo_accrued","overflow","textAlign","width","map","i","x","ivnStatePubKey","manager","owner","amount","mngo_debt","start_index","has_withdrawn","withdrawn_from_margin"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { createAssociatedTokenAccount, createAssociatedTokenAccountIfNotExist, createKeyIfNotExists, createTokenAccountIfNotExist, findAssociatedTokenAddress, setWalletTransaction, signAndSendTransaction } from '../utils/web3'\nimport { connection, FUND_ACCOUNT_KEY, platformStateAccount, PLATFORM_ACCOUNT_KEY, programId } from '../utils/constants'\nimport { GlobalState } from '../store/globalState';\nimport { PublicKey, Transaction, TransactionInstruction } from '@solana/web3.js';\nimport { TOKEN_PROGRAM_ID } from '@project-serum/serum/lib/token-instructions';\nimport { FUND_DATA, INVESTOR_DATA, PLATFORM_DATA, SPL_TOKEN_MINT_DATA, U64F64 } from '../utils/programLayouts';\nimport { Badge } from 'reactstrap';\nimport BN from 'bn.js';\nimport { Card, Col, Row ,Table} from 'reactstrap';\nimport { Blob, seq, struct, u32, u8, u16, ns64 ,nu64} from 'buffer-layout';\n\nexport const AllFundsInvestors = () => {\n\n  const [investments, setInvestments] = useState([])\n  const [funds, setFunds] = useState([])\n\n  const handleGetAllInvestments = async () => {\n\n    //  const userkey = new PublicKey('zRzdC1b2zJte4rMjfaSFZwbnBfL1kNYaTAF4UC4bqpx');\n    //  const key = walletProvider?.publicKey;\n    let investments = await connection.getProgramAccounts(programId, { filters: [\n      { dataSize: INVESTOR_DATA.span },\n      // {\n      //   memcmp: { offset: INVESTOR_DATA.offsetOf('owner'), bytes: userkey.toBase58() }\n      // }\n    ] });\n    // console.log(\"investments::\",investments)\n    const newInvestors = []\n    for (const investment of investments) {\n      const invStateData = INVESTOR_DATA.decode(investment.account.data)\n      invStateData['ivnStatePubKey'] = investment.pubkey;\n      if (invStateData.is_initialized) {\n        newInvestors.push(invStateData)\n      }\n    }\n    console.log(\"newInvestors::\",newInvestors)\n    setInvestments(newInvestors);\n  }\n\n  const handleGetAllFunds = async () => {\n    const managers = []\n    const allFunds = await connection.getProgramAccounts(programId, { filters: [{ dataSize: FUND_DATA.span }] });\n\n    for (const data of allFunds) {\n        const decodedData = FUND_DATA.decode(data.account.data);\n        \n        if (decodedData.is_initialized) {\n            managers.push({\n                fundState : decodedData,\n                fundPDA: decodedData.fund_pda.toBase58(),\n                fundManager: decodedData.manager_account.toBase58(),\n                vault_key: decodedData.vault_key.toBase58(),\n                mngo_vault_key: decodedData.mngo_vault_key.toBase58(),\n                mango_account: decodedData.mango_account.toBase58(),\n               \n                mngo_per_share: decodedData.mngo_per_share.toString(),\n                mngo_manager: decodedData.mngo_manager.toString(),\n                mngo_accrued: decodedData.mngo_accrued.toString(),\n                total_mngo_accrued: decodedData.total_mngo_accrued.toString(),\n\n                // minAmount: (new TokenAmount(decodedData.min_amount.toNumber(), TOKENS.USDC.decimals)).toEther().toNumber()\n            });\n        }\n    }\n    console.log(\"managers:\",managers);\n    setFunds(managers);\n  }\n\n  return (\n    <div className=\"form-div\">\n       <Card className=\"justify-content-center\">\n      <Row className=\"justify-content-between\">\n       <Col lg=\"12\" xs=\"12\">\n      <h4>Investments</h4>\n      <button onClick={handleGetAllInvestments}> get All Investments</button>\n\n      <Table \n        className=\"tablesorter\"\n        responsive\n        width=\"100%\"\n        style={{ overflow: 'hidden !important', textAlign: 'center' }}\n        >\n            <thead className=\"text-primary\">\n                            <tr>\n                              <th style={{ width: \"15%\" }}>index</th>\n                              <th style={{ width: \"15%\" }}>ivnStatePubKey</th>\n                              <th style={{ width: \"15%\" }}>manager</th>\n                              <th style={{ width: \"15%\" }}>owner</th>\n                              <th style={{ width: \"15%\" }}>amount</th>\n                              <th style={{ width: \"15%\" }}>mngo_debt</th>\n                              <th style={{ width: \"15%\" }}>start_index</th>\n                              <th style={{ width: \"15%\" }}>has_withdrawn</th>\n                              <th style={{ width: \"15%\" }}>withdrawn_from_margin</th>\n                            </tr>\n             </thead>\n        <tbody>\n          {\n            investments && \n\n            investments.map((i,x)=>{\n               return <tr key={i?.ivnStatePubKey?.toBase58()}>\n                 <td >{x}</td>\n                 <td >{i?.ivnStatePubKey?.toBase58()}</td>\n                 <td >{i?.manager?.toBase58()}</td>\n                 <td >{i?.owner?.toBase58()}</td>\n                 <td>{i?.amount?.toString()/10**6}</td>\n                 <td>{i?.mngo_debt?.toString()}</td>\n                 <td>{i?.start_index?.toString()}</td>\n\n                 <td>{i?.has_withdrawn}</td>\n                 <td>{i?.withdrawn_from_margin}</td>\n               </tr>\n            })\n          }\n            </tbody>\n          </Table>\n\n     \n      </Col>\n      </Row>\n      <Row className=\"justify-content-between\">\n      <Col lg=\"10\" xs=\"10\">\n      <h4>Funds</h4>\n      \n      <button onClick={handleGetAllFunds}> get All Funds</button>\n\n      <Table \n        className=\"tablesorter\"\n        responsive\n        width=\"100%\"\n        style={{ overflow: 'hidden !important', textAlign: 'center' }}\n        >\n            <thead className=\"text-primary\">\n                            <tr>\n                              <th style={{ width: \"15%\" }}>index</th>\n                              <th style={{ width: \"15%\" }}>fundManager</th>\n                              <th style={{ width: \"15%\" }}>fundPDA</th>\n\n                              <th style={{ width: \"15%\" }}>vault_key</th>\n                              <th style={{ width: \"15%\" }}>mngo_vault_key</th>\n                              <th style={{ width: \"15%\" }}>mango_account</th>\n\n                              <th style={{ width: \"15%\" }}>mngo_per_share</th>\n                              <th style={{ width: \"15%\" }}>mngo_manager</th>\n                              <th style={{ width: \"15%\" }}>mngo_accrued</th>\n                              <th style={{ width: \"15%\" }}>total_mngo_accrued</th>\n\n                            </tr>\n                          </thead>\n\n\n        <tbody>\n          {\n            funds && \n\n            funds.map((i,x)=>{\n               return <tr key={x}>\n                 <td >{x}</td>\n                 <td >{i?.fundManager}</td>\n                 <td >{i?.fundPDA}</td>\n                \n                 <td >{i?.vault_key}</td>\n                 <td >{i?.mngo_vault_key}</td>\n                 <td >{i?.mango_account}</td>\n                 <td >{i?.mngo_per_share}</td>\n                 <td >{i?.mngo_manager}</td>\n                 <td >{i?.mngo_accrued}</td>\n                 <td >{i?.total_mngo_accrued}</td>\n               \n               </tr>\n            })\n          }\n            </tbody>\n          </Table> \n\n      </Col>\n            </Row>\n      </Card>\n    </div>\n  )\n}\n\n"]},"metadata":{},"sourceType":"module"}