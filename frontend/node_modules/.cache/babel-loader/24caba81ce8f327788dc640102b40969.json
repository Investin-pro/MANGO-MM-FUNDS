{"ast":null,"code":"var _jsxFileName = \"/Users/zohebshahzan/code/Solana-2/frontend/src/components/AllFundsInvestors.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { createAssociatedTokenAccount, createAssociatedTokenAccountIfNotExist, createKeyIfNotExists, createTokenAccountIfNotExist, findAssociatedTokenAddress, setWalletTransaction, signAndSendTransaction } from '../utils/web3';\nimport { connection, FUND_ACCOUNT_KEY, platformStateAccount, PLATFORM_ACCOUNT_KEY, programId } from '../utils/constants';\nimport { GlobalState } from '../store/globalState';\nimport { PublicKey, Transaction, TransactionInstruction } from '@solana/web3.js';\nimport { TOKEN_PROGRAM_ID } from '@project-serum/serum/lib/token-instructions';\nimport { FUND_DATA, INVESTOR_DATA, PLATFORM_DATA, SPL_TOKEN_MINT_DATA, U64F64 } from '../utils/programLayouts';\nimport { Badge } from 'reactstrap';\nimport BN from 'bn.js';\nimport { Card, Col, Row, Table } from 'reactstrap';\nimport { Blob, seq, struct, u32, u8, u16, ns64, nu64 } from 'buffer-layout';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AllFundsInvestors = () => {\n  _s();\n\n  const [investments, setInvestments] = useState([]);\n  const [funds, setFunds] = useState([]);\n\n  const handleGetAllInvestments = async () => {\n    //  const userkey = new PublicKey('zRzdC1b2zJte4rMjfaSFZwbnBfL1kNYaTAF4UC4bqpx');\n    //  const key = walletProvider?.publicKey;\n    let investments = await connection.getProgramAccounts(programId, {\n      filters: [{\n        dataSize: INVESTOR_DATA.span\n      } // {\n      //   memcmp: { offset: INVESTOR_DATA.offsetOf('owner'), bytes: userkey.toBase58() }\n      // }\n      ]\n    }); // console.log(\"investments::\",investments)\n\n    const newInvestors = [];\n\n    for (const investment of investments) {\n      const invStateData = INVESTOR_DATA.decode(investment.account.data);\n      invStateData['ivnStatePubKey'] = investment.pubkey;\n\n      if (invStateData.is_initialized) {\n        newInvestors.push(invStateData);\n      }\n    }\n\n    console.log(\"newInvestors::\", newInvestors);\n    setInvestments(newInvestors);\n  };\n\n  const handleGetAllFunds = async () => {\n    const managers = [];\n    const allFunds = await connection.getProgramAccounts(programId, {\n      filters: [{\n        dataSize: FUND_DATA.span\n      }]\n    });\n\n    for (const data of allFunds) {\n      const decodedData = FUND_DATA.decode(data.account.data);\n\n      if (decodedData.is_initialized) {\n        managers.push({\n          fundState: decodedData,\n          fundPDA: data.pubkey.toBase58(),\n          no_of_investments: decodedData.no_of_investments,\n          min_amount: decodedData.min_amount.toString(),\n          performance_fee_percentage: decodedData.performance_fee_percentage.toString(),\n          total_amount: decodedData.total_amount.toString(),\n          current_index: decodedData.current_index.toString(),\n          pending_deposits: decodedData.pending_deposits.toString(),\n          pending_withdrawals: decodedData.pending_withdrawals.toString(),\n          manager_account: decodedData.manager_account.toBase58(),\n          usdc_vault_key: decodedData.usdc_vault_key.toBase58(),\n          mango_account: decodedData.mango_account.toBase58(),\n          delegate: decodedData.delegate.toBase58()\n        });\n      }\n    }\n\n    console.log(\"managers:\", managers);\n    setFunds(managers);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"form-div\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: \"justify-content-center\",\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        className: \"justify-content-between\",\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          lg: \"12\",\n          xs: \"12\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Investments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleGetAllInvestments,\n            children: \" get All Investments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            className: \"tablesorter\",\n            responsive: true,\n            width: \"100%\",\n            style: {\n              overflow: 'hidden !important',\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-primary\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"index\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 93,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"ivnStatePubKey\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 94,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"fund\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 95,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"owner\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 96,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"investment_status\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 97,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 98,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"start_index\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 99,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: investments && investments.map((i, x) => {\n                var _i$ivnStatePubKey, _i$ivnStatePubKey2, _i$fund, _i$owner, _i$amount, _i$start_index;\n\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    children: x\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 109,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$ivnStatePubKey2 = i.ivnStatePubKey) === null || _i$ivnStatePubKey2 === void 0 ? void 0 : _i$ivnStatePubKey2.toBase58()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 110,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$fund = i.fund) === null || _i$fund === void 0 ? void 0 : _i$fund.toBase58()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 111,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$owner = i.owner) === null || _i$owner === void 0 ? void 0 : _i$owner.toBase58()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 112,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.investment_status\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 113,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: (i === null || i === void 0 ? void 0 : (_i$amount = i.amount) === null || _i$amount === void 0 ? void 0 : _i$amount.toString()) / 10 ** 6\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 114,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : (_i$start_index = i.start_index) === null || _i$start_index === void 0 ? void 0 : _i$start_index.toString()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 115,\n                    columnNumber: 23\n                  }, this)]\n                }, i === null || i === void 0 ? void 0 : (_i$ivnStatePubKey = i.ivnStatePubKey) === null || _i$ivnStatePubKey === void 0 ? void 0 : _i$ivnStatePubKey.toBase58(), true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 108,\n                  columnNumber: 28\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        className: \"justify-content-between\",\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          lg: \"12\",\n          xs: \"12\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Funds\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleGetAllFunds,\n            children: \" get All Funds\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            className: \"tablesorter\",\n            responsive: true,\n            width: \"100%\",\n            style: {\n              overflow: 'hidden !important',\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-primary\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"index\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 140,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"fundManager\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"fundPDA\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 142,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"min_amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 144,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"performance_fee_percentage\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"total_amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"current_index\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 148,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  style: {\n                    width: \"15%\"\n                  },\n                  children: \"mango_account\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: funds && funds.map((i, x) => {\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    children: x\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 162,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.manager_account\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 163,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.fundPDA\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 164,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.min_amount\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.performance_fee_percentage\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.total_amount\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 168,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.current_index\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: i === null || i === void 0 ? void 0 : i.mango_account\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 23\n                  }, this)]\n                }, x, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 28\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AllFundsInvestors, \"Es7VZul840z8Rbk62bZDvpJrP9w=\");\n\n_c = AllFundsInvestors;\n\nvar _c;\n\n$RefreshReg$(_c, \"AllFundsInvestors\");","map":{"version":3,"sources":["/Users/zohebshahzan/code/Solana-2/frontend/src/components/AllFundsInvestors.js"],"names":["React","useEffect","useState","createAssociatedTokenAccount","createAssociatedTokenAccountIfNotExist","createKeyIfNotExists","createTokenAccountIfNotExist","findAssociatedTokenAddress","setWalletTransaction","signAndSendTransaction","connection","FUND_ACCOUNT_KEY","platformStateAccount","PLATFORM_ACCOUNT_KEY","programId","GlobalState","PublicKey","Transaction","TransactionInstruction","TOKEN_PROGRAM_ID","FUND_DATA","INVESTOR_DATA","PLATFORM_DATA","SPL_TOKEN_MINT_DATA","U64F64","Badge","BN","Card","Col","Row","Table","Blob","seq","struct","u32","u8","u16","ns64","nu64","AllFundsInvestors","investments","setInvestments","funds","setFunds","handleGetAllInvestments","getProgramAccounts","filters","dataSize","span","newInvestors","investment","invStateData","decode","account","data","pubkey","is_initialized","push","console","log","handleGetAllFunds","managers","allFunds","decodedData","fundState","fundPDA","toBase58","no_of_investments","min_amount","toString","performance_fee_percentage","total_amount","current_index","pending_deposits","pending_withdrawals","manager_account","usdc_vault_key","mango_account","delegate","overflow","textAlign","width","map","i","x","ivnStatePubKey","fund","owner","investment_status","amount","start_index"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,4BAAT,EAAuCC,sCAAvC,EAA+EC,oBAA/E,EAAqGC,4BAArG,EAAmIC,0BAAnI,EAA+JC,oBAA/J,EAAqLC,sBAArL,QAAmN,eAAnN;AACA,SAASC,UAAT,EAAqBC,gBAArB,EAAuCC,oBAAvC,EAA6DC,oBAA7D,EAAmFC,SAAnF,QAAoG,oBAApG;AACA,SAASC,WAAT,QAA4B,sBAA5B;AACA,SAASC,SAAT,EAAoBC,WAApB,EAAiCC,sBAAjC,QAA+D,iBAA/D;AACA,SAASC,gBAAT,QAAiC,6CAAjC;AACA,SAASC,SAAT,EAAoBC,aAApB,EAAmCC,aAAnC,EAAkDC,mBAAlD,EAAuEC,MAAvE,QAAqF,yBAArF;AACA,SAASC,KAAT,QAAsB,YAAtB;AACA,OAAOC,EAAP,MAAe,OAAf;AACA,SAASC,IAAT,EAAeC,GAAf,EAAoBC,GAApB,EAAyBC,KAAzB,QAAsC,YAAtC;AACA,SAASC,IAAT,EAAeC,GAAf,EAAoBC,MAApB,EAA4BC,GAA5B,EAAiCC,EAAjC,EAAqCC,GAArC,EAA0CC,IAA1C,EAAgDC,IAAhD,QAA4D,eAA5D;;AAEA,OAAO,MAAMC,iBAAiB,GAAG,MAAM;AAAA;;AAErC,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCvC,QAAQ,CAAC,EAAD,CAA9C;AACA,QAAM,CAACwC,KAAD,EAAQC,QAAR,IAAoBzC,QAAQ,CAAC,EAAD,CAAlC;;AAEA,QAAM0C,uBAAuB,GAAG,YAAY;AAE1C;AACA;AACA,QAAIJ,WAAW,GAAG,MAAM9B,UAAU,CAACmC,kBAAX,CAA8B/B,SAA9B,EAAyC;AAC/DgC,MAAAA,OAAO,EAAE,CACP;AAAEC,QAAAA,QAAQ,EAAE1B,aAAa,CAAC2B;AAA1B,OADO,CAEP;AACA;AACA;AAJO;AADsD,KAAzC,CAAxB,CAJ0C,CAY1C;;AACA,UAAMC,YAAY,GAAG,EAArB;;AACA,SAAK,MAAMC,UAAX,IAAyBV,WAAzB,EAAsC;AACpC,YAAMW,YAAY,GAAG9B,aAAa,CAAC+B,MAAd,CAAqBF,UAAU,CAACG,OAAX,CAAmBC,IAAxC,CAArB;AACAH,MAAAA,YAAY,CAAC,gBAAD,CAAZ,GAAiCD,UAAU,CAACK,MAA5C;;AACA,UAAIJ,YAAY,CAACK,cAAjB,EAAiC;AAC/BP,QAAAA,YAAY,CAACQ,IAAb,CAAkBN,YAAlB;AACD;AACF;;AACDO,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BV,YAA9B;AACAR,IAAAA,cAAc,CAACQ,YAAD,CAAd;AACD,GAvBD;;AAyBA,QAAMW,iBAAiB,GAAG,YAAY;AACpC,UAAMC,QAAQ,GAAG,EAAjB;AACA,UAAMC,QAAQ,GAAG,MAAMpD,UAAU,CAACmC,kBAAX,CAA8B/B,SAA9B,EAAyC;AAAEgC,MAAAA,OAAO,EAAE,CAAC;AAAEC,QAAAA,QAAQ,EAAE3B,SAAS,CAAC4B;AAAtB,OAAD;AAAX,KAAzC,CAAvB;;AAEA,SAAK,MAAMM,IAAX,IAAmBQ,QAAnB,EAA6B;AAC3B,YAAMC,WAAW,GAAG3C,SAAS,CAACgC,MAAV,CAAiBE,IAAI,CAACD,OAAL,CAAaC,IAA9B,CAApB;;AAEA,UAAIS,WAAW,CAACP,cAAhB,EAAgC;AAC9BK,QAAAA,QAAQ,CAACJ,IAAT,CAAc;AACZO,UAAAA,SAAS,EAAED,WADC;AAEZE,UAAAA,OAAO,EAAEX,IAAI,CAACC,MAAL,CAAYW,QAAZ,EAFG;AAGZC,UAAAA,iBAAiB,EAAEJ,WAAW,CAACI,iBAHnB;AAIZC,UAAAA,UAAU,EAAEL,WAAW,CAACK,UAAZ,CAAuBC,QAAvB,EAJA;AAKZC,UAAAA,0BAA0B,EAAEP,WAAW,CAACO,0BAAZ,CAAuCD,QAAvC,EALhB;AAMZE,UAAAA,YAAY,EAAER,WAAW,CAACQ,YAAZ,CAAyBF,QAAzB,EANF;AAQZG,UAAAA,aAAa,EAAET,WAAW,CAACS,aAAZ,CAA0BH,QAA1B,EARH;AAUZI,UAAAA,gBAAgB,EAAEV,WAAW,CAACU,gBAAZ,CAA6BJ,QAA7B,EAVN;AAWZK,UAAAA,mBAAmB,EAAEX,WAAW,CAACW,mBAAZ,CAAgCL,QAAhC,EAXT;AAcZM,UAAAA,eAAe,EAAEZ,WAAW,CAACY,eAAZ,CAA4BT,QAA5B,EAdL;AAeZU,UAAAA,cAAc,EAAEb,WAAW,CAACa,cAAZ,CAA2BV,QAA3B,EAfJ;AAgBZW,UAAAA,aAAa,EAAEd,WAAW,CAACc,aAAZ,CAA0BX,QAA1B,EAhBH;AAiBZY,UAAAA,QAAQ,EAAEf,WAAW,CAACe,QAAZ,CAAqBZ,QAArB;AAjBE,SAAd;AAoBD;AACF;;AACDR,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBE,QAAzB;AACAlB,IAAAA,QAAQ,CAACkB,QAAD,CAAR;AACD,GAhCD;;AAkCA,sBACE;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA,2BACE,QAAC,IAAD;AAAM,MAAA,SAAS,EAAC,wBAAhB;AAAA,8BACE,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,yBAAf;AAAA,+BACE,QAAC,GAAD;AAAK,UAAA,EAAE,EAAC,IAAR;AAAa,UAAA,EAAE,EAAC,IAAhB;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAQ,YAAA,OAAO,EAAEjB,uBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAIE,QAAC,KAAD;AACE,YAAA,SAAS,EAAC,aADZ;AAEE,YAAA,UAAU,MAFZ;AAGE,YAAA,KAAK,EAAC,MAHR;AAIE,YAAA,KAAK,EAAE;AAAEmC,cAAAA,QAAQ,EAAE,mBAAZ;AAAiCC,cAAAA,SAAS,EAAE;AAA5C,aAJT;AAAA,oCAME;AAAO,cAAA,SAAS,EAAC,cAAjB;AAAA,qCACE;AAAA,wCACE;AAAI,kBAAA,KAAK,EAAE;AAAEC,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF,eAGE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHF,eAIE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAJF,eAKE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBALF,eAME;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBANF,eAOE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAPF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBANF,eAkBE;AAAA,wBAEIzC,WAAW,IAEXA,WAAW,CAAC0C,GAAZ,CAAgB,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAAA;;AACxB,oCAAO;AAAA,0CACL;AAAA,8BAAMA;AAAN;AAAA;AAAA;AAAA;AAAA,0BADK,eAEL;AAAA,8BAAMD,CAAN,aAAMA,CAAN,6CAAMA,CAAC,CAAEE,cAAT,uDAAM,mBAAmBnB,QAAnB;AAAN;AAAA;AAAA;AAAA;AAAA,0BAFK,eAGL;AAAA,8BAAMiB,CAAN,aAAMA,CAAN,kCAAMA,CAAC,CAAEG,IAAT,4CAAM,QAASpB,QAAT;AAAN;AAAA;AAAA;AAAA;AAAA,0BAHK,eAIL;AAAA,8BAAMiB,CAAN,aAAMA,CAAN,mCAAMA,CAAC,CAAEI,KAAT,6CAAM,SAAUrB,QAAV;AAAN;AAAA;AAAA;AAAA;AAAA,0BAJK,eAKL;AAAA,8BAAKiB,CAAL,aAAKA,CAAL,uBAAKA,CAAC,CAAEK;AAAR;AAAA;AAAA;AAAA;AAAA,0BALK,eAML;AAAA,8BAAK,CAAAL,CAAC,SAAD,IAAAA,CAAC,WAAD,yBAAAA,CAAC,CAAEM,MAAH,wDAAWpB,QAAX,MAAwB,MAAM;AAAnC;AAAA;AAAA;AAAA;AAAA,0BANK,eAOL;AAAA,8BAAKc,CAAL,aAAKA,CAAL,yCAAKA,CAAC,CAAEO,WAAR,mDAAK,eAAgBrB,QAAhB;AAAL;AAAA;AAAA;AAAA;AAAA,0BAPK;AAAA,mBAASc,CAAT,aAASA,CAAT,4CAASA,CAAC,CAAEE,cAAZ,sDAAS,kBAAmBnB,QAAnB,EAAT;AAAA;AAAA;AAAA;AAAA,wBAAP;AAUD,eAXD;AAJJ;AAAA;AAAA;AAAA;AAAA,oBAlBF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADF,eA+CE,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,yBAAf;AAAA,+BACE,QAAC,GAAD;AAAK,UAAA,EAAE,EAAC,IAAR;AAAa,UAAA,EAAE,EAAC,IAAhB;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAGE;AAAQ,YAAA,OAAO,EAAEN,iBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHF,eAKE,QAAC,KAAD;AACE,YAAA,SAAS,EAAC,aADZ;AAEE,YAAA,UAAU,MAFZ;AAGE,YAAA,KAAK,EAAC,MAHR;AAIE,YAAA,KAAK,EAAE;AAAEmB,cAAAA,QAAQ,EAAE,mBAAZ;AAAiCC,cAAAA,SAAS,EAAE;AAA5C,aAJT;AAAA,oCAME;AAAO,cAAA,SAAS,EAAC,cAAjB;AAAA,qCACE;AAAA,wCACE;AAAI,kBAAA,KAAK,EAAE;AAAEC,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF,eAGE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHF,eAKE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBALF,eAME;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBANF,eAOE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAPF,eASE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBATF,eAUE;AAAI,kBAAA,KAAK,EAAE;AAAEA,oBAAAA,KAAK,EAAE;AAAT,mBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAVF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBANF,eAwBE;AAAA,wBAEIvC,KAAK,IAELA,KAAK,CAACwC,GAAN,CAAU,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAClB,oCAAO;AAAA,0CACL;AAAA,8BAAMA;AAAN;AAAA;AAAA;AAAA;AAAA,0BADK,eAEL;AAAA,8BAAMD,CAAN,aAAMA,CAAN,uBAAMA,CAAC,CAAER;AAAT;AAAA;AAAA;AAAA;AAAA,0BAFK,eAGL;AAAA,8BAAMQ,CAAN,aAAMA,CAAN,uBAAMA,CAAC,CAAElB;AAAT;AAAA;AAAA;AAAA;AAAA,0BAHK,eAKL;AAAA,8BAAMkB,CAAN,aAAMA,CAAN,uBAAMA,CAAC,CAAEf;AAAT;AAAA;AAAA;AAAA;AAAA,0BALK,eAML;AAAA,8BAAMe,CAAN,aAAMA,CAAN,uBAAMA,CAAC,CAAEb;AAAT;AAAA;AAAA;AAAA;AAAA,0BANK,eAOL;AAAA,8BAAMa,CAAN,aAAMA,CAAN,uBAAMA,CAAC,CAAEZ;AAAT;AAAA;AAAA;AAAA;AAAA,0BAPK,eAQL;AAAA,8BAAMY,CAAN,aAAMA,CAAN,uBAAMA,CAAC,CAAEX;AAAT;AAAA;AAAA;AAAA;AAAA,0BARK,eASL;AAAA,8BAAMW,CAAN,aAAMA,CAAN,uBAAMA,CAAC,CAAEN;AAAT;AAAA;AAAA;AAAA;AAAA,0BATK;AAAA,mBAASO,CAAT;AAAA;AAAA;AAAA;AAAA,wBAAP;AAYD,eAbD;AAJJ;AAAA;AAAA;AAAA;AAAA,oBAxBF;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cA/CF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADF;AA0GD,CA1KM;;GAAM7C,iB;;KAAAA,iB","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { createAssociatedTokenAccount, createAssociatedTokenAccountIfNotExist, createKeyIfNotExists, createTokenAccountIfNotExist, findAssociatedTokenAddress, setWalletTransaction, signAndSendTransaction } from '../utils/web3'\nimport { connection, FUND_ACCOUNT_KEY, platformStateAccount, PLATFORM_ACCOUNT_KEY, programId } from '../utils/constants'\nimport { GlobalState } from '../store/globalState';\nimport { PublicKey, Transaction, TransactionInstruction } from '@solana/web3.js';\nimport { TOKEN_PROGRAM_ID } from '@project-serum/serum/lib/token-instructions';\nimport { FUND_DATA, INVESTOR_DATA, PLATFORM_DATA, SPL_TOKEN_MINT_DATA, U64F64 } from '../utils/programLayouts';\nimport { Badge } from 'reactstrap';\nimport BN from 'bn.js';\nimport { Card, Col, Row, Table } from 'reactstrap';\nimport { Blob, seq, struct, u32, u8, u16, ns64, nu64 } from 'buffer-layout';\n\nexport const AllFundsInvestors = () => {\n\n  const [investments, setInvestments] = useState([])\n  const [funds, setFunds] = useState([])\n\n  const handleGetAllInvestments = async () => {\n\n    //  const userkey = new PublicKey('zRzdC1b2zJte4rMjfaSFZwbnBfL1kNYaTAF4UC4bqpx');\n    //  const key = walletProvider?.publicKey;\n    let investments = await connection.getProgramAccounts(programId, {\n      filters: [\n        { dataSize: INVESTOR_DATA.span },\n        // {\n        //   memcmp: { offset: INVESTOR_DATA.offsetOf('owner'), bytes: userkey.toBase58() }\n        // }\n      ]\n    });\n    // console.log(\"investments::\",investments)\n    const newInvestors = []\n    for (const investment of investments) {\n      const invStateData = INVESTOR_DATA.decode(investment.account.data)\n      invStateData['ivnStatePubKey'] = investment.pubkey;\n      if (invStateData.is_initialized) {\n        newInvestors.push(invStateData)\n      }\n    }\n    console.log(\"newInvestors::\", newInvestors)\n    setInvestments(newInvestors);\n  }\n\n  const handleGetAllFunds = async () => {\n    const managers = []\n    const allFunds = await connection.getProgramAccounts(programId, { filters: [{ dataSize: FUND_DATA.span }] });\n\n    for (const data of allFunds) {\n      const decodedData = FUND_DATA.decode(data.account.data);\n\n      if (decodedData.is_initialized) {\n        managers.push({\n          fundState: decodedData,\n          fundPDA: data.pubkey.toBase58(),\n          no_of_investments: decodedData.no_of_investments,\n          min_amount: decodedData.min_amount.toString(),\n          performance_fee_percentage: decodedData.performance_fee_percentage.toString(),\n          total_amount: decodedData.total_amount.toString(),\n\n          current_index: decodedData.current_index.toString(),\n\n          pending_deposits: decodedData.pending_deposits.toString(),\n          pending_withdrawals: decodedData.pending_withdrawals.toString(),\n\n\n          manager_account: decodedData.manager_account.toBase58(),\n          usdc_vault_key: decodedData.usdc_vault_key.toBase58(),\n          mango_account: decodedData.mango_account.toBase58(),\n          delegate: decodedData.delegate.toBase58(),\n\n        });\n      }\n    }\n    console.log(\"managers:\", managers);\n    setFunds(managers);\n  }\n\n  return (\n    <div className=\"form-div\">\n      <Card className=\"justify-content-center\">\n        <Row className=\"justify-content-between\">\n          <Col lg=\"12\" xs=\"12\">\n            <h4>Investments</h4>\n            <button onClick={handleGetAllInvestments}> get All Investments</button>\n\n            <Table\n              className=\"tablesorter\"\n              responsive\n              width=\"100%\"\n              style={{ overflow: 'hidden !important', textAlign: 'center' }}\n            >\n              <thead className=\"text-primary\">\n                <tr>\n                  <th style={{ width: \"15%\" }}>index</th>\n                  <th style={{ width: \"15%\" }}>ivnStatePubKey</th>\n                  <th style={{ width: \"15%\" }}>fund</th>\n                  <th style={{ width: \"15%\" }}>owner</th>\n                  <th style={{ width: \"15%\" }}>investment_status</th>\n                  <th style={{ width: \"15%\" }}>amount</th>\n                  <th style={{ width: \"15%\" }}>start_index</th>\n                \n                </tr>\n              </thead>\n              <tbody>\n                {\n                  investments &&\n\n                  investments.map((i, x) => {\n                    return <tr key={i?.ivnStatePubKey?.toBase58()}>\n                      <td >{x}</td>\n                      <td >{i?.ivnStatePubKey?.toBase58()}</td>\n                      <td >{i?.fund?.toBase58()}</td>\n                      <td >{i?.owner?.toBase58()}</td>\n                      <td>{i?.investment_status}</td>\n                      <td>{i?.amount?.toString() / 10 ** 6}</td>\n                      <td>{i?.start_index?.toString()}</td>\n\n                    </tr>\n                  })\n                }\n              </tbody>\n            </Table>\n\n\n          </Col>\n        </Row>\n        <Row className=\"justify-content-between\">\n          <Col lg=\"12\" xs=\"12\">\n            <h4>Funds</h4>\n\n            <button onClick={handleGetAllFunds}> get All Funds</button>\n\n            <Table\n              className=\"tablesorter\"\n              responsive\n              width=\"100%\"\n              style={{ overflow: 'hidden !important', textAlign: 'center' }}\n            >\n              <thead className=\"text-primary\">\n                <tr>\n                  <th style={{ width: \"15%\" }}>index</th>\n                  <th style={{ width: \"15%\" }}>fundManager</th>\n                  <th style={{ width: \"15%\" }}>fundPDA</th>\n\n                  <th style={{ width: \"15%\" }}>min_amount</th>\n                  <th style={{ width: \"15%\" }}>performance_fee_percentage</th>\n                  <th style={{ width: \"15%\" }}>total_amount</th>\n\n                  <th style={{ width: \"15%\" }}>current_index</th>\n                  <th style={{ width: \"15%\" }}>mango_account</th>\n\n\n                </tr>\n              </thead>\n\n\n              <tbody>\n                {\n                  funds &&\n\n                  funds.map((i, x) => {\n                    return <tr key={x}>\n                      <td >{x}</td>\n                      <td >{i?.manager_account}</td>\n                      <td >{i?.fundPDA}</td>\n\n                      <td >{i?.min_amount}</td>\n                      <td >{i?.performance_fee_percentage}</td>\n                      <td >{i?.total_amount}</td>\n                      <td >{i?.current_index}</td>\n                      <td >{i?.mango_account}</td>\n\n                    </tr>\n                  })\n                }\n              </tbody>\n            </Table>\n\n          </Col>\n        </Row>\n      </Card>\n    </div>\n  )\n}\n\n"]},"metadata":{},"sourceType":"module"}